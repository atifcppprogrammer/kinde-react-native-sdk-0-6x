var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _reactNative=require("react-native");var _urlParse=_interopRequireDefault(require("url-parse"));var _Storage=require("../Storage");var _Utils=require("../Utils");var AuthorizationCode=function(){function AuthorizationCode(){(0,_classCallCheck2["default"])(this,AuthorizationCode);}(0,_createClass2["default"])(AuthorizationCode,[{key:"login",value:function login(kindSDK){var usePKCE=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var startPage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'login';var additionalParameters=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var URLParsed=(0,_urlParse["default"])(kindSDK.authorizationEndpoint,true);URLParsed.query['client_id']=kindSDK.clientId;URLParsed.query['redirect_uri']=kindSDK.redirectUri;URLParsed.query['client_secret']=kindSDK.clientSecret;URLParsed.query['grant_type']='authorization_code';URLParsed.query['scope']=kindSDK.scope;URLParsed.query['start_page']=startPage;URLParsed.query['response_type']='code';var stateGenerated=(0,_Utils.generateRandomString)();URLParsed.query['state']=stateGenerated;(0,_Utils.addAdditionalParameters)(URLParsed.query,additionalParameters);_Storage.sessionStorage.setState(stateGenerated);if(usePKCE){var challenge=(0,_Utils.generateChallenge)();URLParsed.query['code_challenge']=challenge.codeChallenge;URLParsed.query['code_challenge_method']='S256';_Storage.sessionStorage.setCodeVerifier(challenge.codeVerifier);}return _reactNative.Linking.openURL(URLParsed.toString());}}]);return AuthorizationCode;}();var _default=AuthorizationCode;exports["default"]=_default;